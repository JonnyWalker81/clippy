╔═══════════════════════════════════════════════════════════════════╗
║           NATIVE CLIPBOARD SYNC - QUICK START GUIDE              ║
╚═══════════════════════════════════════════════════════════════════╝

Simple bash scripts for clipboard sync between NixOS VM ↔ macOS host
Uses: pbcopy/pbpaste (macOS) + xclip/wl-clipboard (NixOS)

┌───────────────────────────────────────────────────────────────────┐
│ MACOS HOST (SERVER)                                               │
└───────────────────────────────────────────────────────────────────┘

1. Install socat (optional but recommended):
   $ brew install socat

2. Start server:
   $ cd /path/to/clippy
   $ ./scripts/native-sync-macos.sh start

3. Check status:
   $ ./scripts/native-sync-check.sh

┌───────────────────────────────────────────────────────────────────┐
│ NIXOS VM (CLIENT)                                                 │
└───────────────────────────────────────────────────────────────────┘

1. Install tools:
   $ nix-shell -p xclip socat netcat

2. Set macOS host IP (if needed):
   $ export NATIVE_SYNC_HOST="10.211.55.2"

3. Start client:
   $ cd /path/to/clippy
   $ ./scripts/native-sync-nixos.sh start

4. Check status:
   $ ./scripts/native-sync-check.sh

┌───────────────────────────────────────────────────────────────────┐
│ TESTING                                                           │
└───────────────────────────────────────────────────────────────────┘

Run test on either machine:
$ ./scripts/native-sync-check.sh test

Copy text on one machine → Check clipboard on other machine!

┌───────────────────────────────────────────────────────────────────┐
│ COMMANDS                                                          │
└───────────────────────────────────────────────────────────────────┘

Start:   ./scripts/native-sync-{macos|nixos}.sh start
Stop:    ./scripts/native-sync-{macos|nixos}.sh stop
Check:   ./scripts/native-sync-{macos|nixos}.sh check
Status:  ./scripts/native-sync-check.sh
Test:    ./scripts/native-sync-check.sh test

┌───────────────────────────────────────────────────────────────────┐
│ LOGS                                                              │
└───────────────────────────────────────────────────────────────────┘

macOS:  /tmp/native-sync-macos.log
NixOS:  /tmp/native-sync-nixos.log

View:   tail -f /tmp/native-sync-*.log

┌───────────────────────────────────────────────────────────────────┐
│ INSTALL AS SERVICE                                                │
└───────────────────────────────────────────────────────────────────┘

macOS (launchd):
1. Edit scripts/native-sync-macos.plist (fix paths)
2. $ cp scripts/native-sync-macos.plist ~/Library/LaunchAgents/
3. $ launchctl load ~/Library/LaunchAgents/native-sync-macos.plist

NixOS (systemd):
1. Edit scripts/native-sync-nixos.service (fix paths)
2. $ mkdir -p ~/.config/systemd/user
3. $ cp scripts/native-sync-nixos.service ~/.config/systemd/user/
4. $ systemctl --user daemon-reload
5. $ systemctl --user enable --now native-sync-nixos

Or add to configuration.nix (see NATIVE_SYNC.md)

┌───────────────────────────────────────────────────────────────────┐
│ TROUBLESHOOTING                                                   │
└───────────────────────────────────────────────────────────────────┘

"Cannot connect":
→ Check server running: ps aux | grep native-sync
→ Check firewall on macOS
→ Ping host: ping 10.211.55.2
→ Test port: nc -zv 10.211.55.2 9877

"Clipboard tool not found":
→ Install: nix-shell -p xclip (or wl-clipboard)
→ Check DISPLAY is set: echo $DISPLAY

"Clipboard empty":
→ Install clipboard manager on NixOS
→ Try manually: xclip -o -selection clipboard

┌───────────────────────────────────────────────────────────────────┐
│ DOCUMENTATION                                                     │
└───────────────────────────────────────────────────────────────────┘

Full docs: NATIVE_SYNC.md
Main docs: README.md

┌───────────────────────────────────────────────────────────────────┐
│ CONFIGURATION                                                     │
└───────────────────────────────────────────────────────────────────┘

Environment variables:

NATIVE_SYNC_HOST=10.211.55.2    # Server IP (client only)
NATIVE_SYNC_PORT=9877           # Port (default: 9877)
NATIVE_SYNC_INTERVAL=0.2        # Poll interval (default: 200ms)
NATIVE_SYNC_VERBOSE=1           # Verbose logging (default: 1)
NATIVE_SYNC_LOG=/tmp/...        # Log file path

Example:
$ NATIVE_SYNC_PORT=9999 ./scripts/native-sync-macos.sh start

┌───────────────────────────────────────────────────────────────────┐
│ FEATURES                                                          │
└───────────────────────────────────────────────────────────────────┘

✓ Bidirectional sync (NixOS ↔ macOS)
✓ Auto-reconnect on disconnect
✓ Change detection (MD5 checksum)
✓ Fast polling (200ms default)
✓ Multiple clipboard tools supported
✓ Service files included
✓ Health checks
✓ Verbose logging
✓ No compilation needed!

Port: 9877 (different from Rust daemon: 9876)

╔═══════════════════════════════════════════════════════════════════╗
║                  Happy clipboard syncing! 📋                      ║
╚═══════════════════════════════════════════════════════════════════╝
